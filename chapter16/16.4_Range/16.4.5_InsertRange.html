<html>

<head></head>

<body>
    <p id="p1"><b>Hello</b> world!</p>
    
    <!-- 16.4.5 范围插入
    
        使用insertNode()方法可以在范围选区的开始位置插入一个节点

        注意, <span>正好插入到"hello"中的"llo"之前, 也就是范围选区的前面
        同时, 也要注意原始的HTML并没有添加或删除<b>元素, 因为这里并没有使用之前提到的方法
        使用这个技术可以插入有用的信息, 比如在外部链接旁边插入一个小图标

        除了向范围中插入内容, 还可以使用surroundContents()方法插入包含范围的内容
        这个方法接收一个参数, 即包含范围内容的节点
        调用这个方法会执行如下操作:
        1. 提取出范围的内容
        2. 在原始文档中范围之前所在的位置插入给定的节点
        3. 将范围对应文档片段的内容添加到给定节点
        这种功能适合在网页中高亮显示某些关键词

        为了插入元素, 范围中必须包含完整的DOM结构
        如果范围中包含部分选择的非文节点, 这个操作会失败并报错
        另外, 如果给定的节点是Document, DocumentType, DocumentFragment类型, 也会导致抛出错误
    -->
    <script>
        let p1 = document.getElementById("p1");
        let helloNode = p1.firstChild.firstChild;
        let worldNode = p1.lastChild;
        
        let range = document.createRange();
        range.setStart(helloNode, 2);
        range.setEnd(worldNode, 3);

        // insertNode()
        // 假设我们想在前面例子中的HTML中插入如下HTML
        // <span style="color: red">Inserted text</span>
        // let span = document.createElement("span");
        // span.style.color = "red";
        // span.appendChild(document.createTextNode("Inserted text"));
        // range.insertNode(span);

        // surroundContents()
        // 以红色背景高亮显示范围选择的文本
        range.selectNode(helloNode);
        let span = document.createElement("span");
        span.style.backgroundColor = "yellow";
        range.surroundContents(span);
    </script>
</body>

</html>