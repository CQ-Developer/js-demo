<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
</head>

<body>

    <!-- 24.7.3 其他事件
        https://developer.mozilla.org/en-US/docs/Web/API/WebSocket#events
    
    WebSocket对象在连接生命周期中有可能触发3个其他事件
    - open: 在连接成功建立时触发
    - close: 在连接关闭时触发
    - error: 在发生错误时触发, 连接无法存续

    WebSocket对象不支持 DOM Level 2 事件监听器, 因此需要使用 DOM Level 0 风格的事件处理程序来监听这些事件

    在这些事件中, 只有close事件的event对象上有额外信息
    这个对象上有3个额外属性: wasClean, code, reason
    其中, wasClean是一个布尔值, 表示连接是否干净的关闭
    code是一个来自服务器的数值状态码
    reason是一个字符串, 包含服务器发来的消息
    可以将这些信息显示给用户或记录到日志
    -->
    <script>
        let socket = new WebSocket("ws://www.example.com/server.php");

        // open
        socket.onopen = function (event) {
            console.log("connection established");
        };

        // close
        socket.onclose = function (event) {
            console.log("connection closed");
        };
        
        // error
        socket.onerror = function (event) {
            console.log("connection error");
        };
    </script>
</body>

</html>