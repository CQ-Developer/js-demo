<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
</head>

<body>

    <!-- 19.2.4.5 检测有效性 P595
    
    使用checkValidity()方法可以检测表单中任意给定字段是否有效
    这个方法在所有表单元素上都可以使用, 如果字段值有效就返回true, 否则返回false
    判断字段是否有效的依据是之前介绍的约束条件
    因此必填字段如果没有值就会被视为无效, 而字段值不匹配pattern属性也会被视为无效

    要检查整个表单是否有效, 可以直接在表单上调用checkValidaity()方法
    这个方法会在所有字段都有效时返回true, 有一个字段无效就返回false

    validity属性可以说明字段为何无效
    该属性是一个对象, 包含一系列返回布尔值的属性
    1 | customError     | 如果设置了setCustomValidity()就返回true, 否则返回false
    2 | patternMismatch | 如果字段不匹配指定的pattern属性则返回true
    3 | rangeOverflow   | 如果字段值大于max的值则返回true
    4 | rangeUnderflow  | 如果字段值小于min的值则返回true
    5 | stepMisMatch    | 如果字段值与min, max, step的值不相符则返回true
    6 | tooLong         | 如果字段值的长度超过了maxLength属性指定的值则返回true
    7 | typeMismatch    | 如果字段值不是email或url要求的格式则返回true
    8 | valid           | 如果其他所有属性的值都是false则返回true, 与checkValidity()的条件一致
    9 | valueMissing    | 如果字段是必填的但没有值则返回true
    -->
    <script>
        // 检查字段是否有效
        if (document.forms[0].elements[0].checkValidity()) {
            // 字段有效
        } else {
            // 字段无效
        }

        // 检查表单的所有字段是否有效
        if (document.forms[0].checkValidity()) {
            // 表单有效
        } else {
            // 表单无效
        }

        // 通过validity属性检查表单字段的有效性
        // 从而获取更具体的信息
        if (input.validity && !input.validity.valid) {
            if (input.validity.valueMissing) {
                console.log("Please specify a value");
            } else if (input.validity.typeMismatch) {
                console.log("Please enter an email address");
            } else {
                console.log("Value is invalid");
            }
        }
    </script>
</body>

</html>